(function(t){function e(e){for(var a,o,r=e[0],l=e[1],c=e[2],d=0,p=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],a=!0,r=1;r<s.length;r++){var l=s[r];0!==i[l]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=s[0]))}return t}var a={},i={app:0},n=[];function o(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=a,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(s,a,function(e){return t[e]}.bind(null,a));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"03e2":function(t,e,s){},"09c9":function(t,e,s){},"19da":function(t,e,s){},"22cf":function(t,e,s){},"30d9":function(t,e,s){},"48fd":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),i=s("f309");a["default"].use(i["a"]);var n=new i["a"]({}),o=s("3304"),r=(s("14d9"),s("2f62")),l=s("bfa9");a["default"].use(r["a"]);const c=new l["a"]({storage:window.localStorage});let u={currentSession:void 0,sessions:void 0,audios:[],biblio:[],userProfile:void 0,user:null,token:null,alerts:[],main_theme:"bg-dark",width:null,theme:"dark",commentsPanel:{audioid:0,audio:{id:null},open:!1}};var d=new r["a"].Store({plugins:[c.plugin],state:{...u},mutations:{setUserProfile:function(t,e){t.userProfile=e},setCurrentSession:function(t,e){t.currentSession=e},setPistPlaylist:function(t,e){t.biblio=e},setToken:function(t,e){t.token=e},setUser:function(t,e){console.log("Set User:",e),t.user=e},setWidth:function(t,e){t.width=e},updateUser:function(t,e){Object.keys(t.user).includes(e.field)&&(t.user[e.field]=e.value)},push_alert:function(t,e){e.id=t.alerts.length+1,t.alerts.push(e)},remove_alert:function(t,e){t.alerts=t.alerts.filter(t=>t.id!==e)},appendSession:function(t,e){t.sessions.push(e)},updateSession:function(t,e){t.sessions.forEach((s,a)=>{s.id==e.sessionid&&s.includes(e.field)&&(t.sessions[a][e.field]=e.value)})},removeSession:function(t,e){t.Sessions=t.sessions.filter(t=>t.id!=e)},setBiblio:function(t,e){t.biblio=e},pushInBiblio:function(t,e){t.biblio.push(e)},removeInBiblio:function(t,e){t.biblio=t.biblio.filter(t=>t.id!=e)},pusProfileSettings:function(t,e){for(const s in e)Object.keys(t.profile_settings).includes(s)?t.profile_settings[s]=e[s]:t.profile_settings={...t.profile_settings,[s]:e[s]}},updateProfileSettings:function(t,e){(void 0).includes(e.field)&&(t.profile_settings[e.field]=e.value)},logout:function(t){Object.assign(t,u),window.location.href="/"},toggleCommentsPanel:function(t,e=null){null!=e?t.commentsPanel.open:t.commentsPanel.open=!t.commentsPanel.open},setCommentsPanelAudio(t,e){t.commentsPanel.audio=e}},actions:{get_pistdata:function(t,e){let s;return t.state.pists.filter(t=>{if(t.id===e.pistid)switch(e.field){case"volume":s=t.volume;break}}),s},getState:function(t){return console.log(t.state),JSON.parse(t.state)}}}),p=s("8c4f"),h=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"search-actions"},[e("Searchbar",{attrs:{placeholder:"Rechercher une création"},on:{searchData:t.searchAudio}}),e("div",{staticClass:"categories-search-buttons"},[e("p",[t._v("catégories:")]),e("GenreTag",{attrs:{text:"Old-school",onClick:()=>{}}})],1)],1),e("div",{staticClass:"list-title-paging"},[e("h3",{staticClass:"list-title"},[t._v("Ecouté")]),e("Paging",{attrs:{totalPage:t.audios.totalPages,itemsPerPage:t.audios.totalItems,currentPage:t.audios.currentPage},on:{changePage:t.onPageChange}})],1),t.dataLoaded?e("div",{staticClass:"audio-list-container"},[e("AudioList",{attrs:{audios:t.audios.datas}})],1):t._e(),e("SimpleAudioPlayerComponent"),e("CommentsPanel",{attrs:{audioid:t.$store.state.commentsPanel.audio.id}})],1)},m=[],f=s("bc3a"),g=s.n(f);const v=window.localStorage.getItem("vuex")?JSON.parse(window.localStorage.getItem("vuex")).token:null,y={baseURL:"http://localhost:3000/api",headers:{Authorization:"Bearer "+v}};var k=g.a.create(y);class C{async all(t){const e=await k.get("/store?page="+t).catch(t=>{console.log(t)});return e.data}async search(t,e){const s=await k.post("/search/audio?page="+e,{query:t}).catch(t=>{console.log(t)});return s.data}}var P=new C,_=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"search-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchKeywords,expression:"searchKeywords"}],staticClass:"searchbar",attrs:{placeholder:t.placeholder,type:"text"},domProps:{value:t.searchKeywords},on:{input:function(e){e.target.composing||(t.searchKeywords=e.target.value)}}})])},b=[],w=(s("8c5b"),{name:"searchbar",props:{placeholder:{required:!0}},data(){return{searchKeywords:""}},mounted(){this.$watch("$data.searchKeywords",this.search)},methods:{search:async function(){this.$emit("searchData",this.searchKeywords)}}}),I=w,x=s("2877"),T=Object(x["a"])(I,_,b,!1,null,null,null),S=T.exports;s("88a7"),s("271a"),s("5494");class ${onPlay(){const t=new Event("spl-play",{bubbles:!0});document.dispatchEvent(t)}onPause(){const t=new Event("spl-pause",{bubbles:!0});document.dispatchEvent(t)}onResume(){const t=new Event("resume");document.dispatchEvent(t)}constructor(){this.initalised=!1,this.currentUrl=void 0,this.audioList=[],this.currentIndex=0,this.audioElement=new Audio,this.audioElement.onended=()=>this.handleAudioEnd(),this.paused=!1,this.currentAudio={},this.globalFallack=void 0}async fetchAudioBuffer(t){try{const e=await fetch(t),s=await e.arrayBuffer();return s}catch(e){return console.error("Error fetching audio buffer:",e),null}}async createAudioBlobUrl(t){if(t){const e=new Blob([t],{type:"audio/mpeg"}),s=URL.createObjectURL(e);this.audioElement.src=s}}getCurrentTime(){return this.audioElement?this.audioElement.currentTime:0}setCurrentTime(t){if(this.audioElement)return this.audioElement.currentTime=t}getDuration(){return this.audioElement.duration}getPlayingMinutes(){return this.audioElement.currentTime}async play(t,e){if(void 0!=e&&(this.currentAudio=e),!this.paused&&this.currentUrl==t&&void 0!=t)return this.audioElement.pause(),this.paused=!0,void this.onPause();if(!t&&!this.currentUrl&&this.audioList.length>0&&(console.log("sete url",this.currentIndex),this.currentUrl=this.audioList[this.currentIndex].src),this.currentUrl!=t||!this.currentUrl){this.currentUrl=void 0!=t?t:this.currentUrl,console.log("current url:",this.currentUrl);const e=await this.fetchAudioBuffer(this.currentUrl);await this.createAudioBlobUrl(e)}this.paused=!1,this.audioElement.play(),this.onPlay()}isPaused(){return this.paused}pause(){this.onPause(),this.audioElement.pause(),this.paused=!0}setAudioList(t){this.audioList=t}getAudioList(){return this.audioList}playNext(){this.currentIndex=(this.currentIndex+1)%this.audioList.length,this.play()}setVolume(t){this.audioElement.volume=t}setFallback(t,e=100){this.fallbackInterval=setInterval(()=>{t(this.getCurrentTime())},e)}setGlobalFallback(t,e=100){this.globalFallack=setInterval(()=>{t(this.getCurrentTime())},e)}clearFallback(){clearInterval(this.fallbackInterval)}clearGlobalFallback(){clearInterval(this.globalFallack)}handleAudioEnd(){this.playNext()}static getInstance(){return $.instance||($.instance=new $),$.instance}getCurrentAudio(){return this.currentAudio}getCurrentUrl(){return this.currentUrl}}var L=$.getInstance(),O=function(){var t=this,e=t._self._c;return e("section",{attrs:{id:"simple-player-container"}},[e("div",{staticClass:"sp-content"},[e("div",{staticClass:"play-container"},[e("PlayPause",{attrs:{onClick:t.play,onPlay:t.isPlaying}})],1),e("p",{ref:"timer",staticClass:"timer-duration"},[t._v("00:00")]),e("Progress",{attrs:{onInput:t.onInputDuration,onPlay:t.isPlaying,"on-grab-duration":t.onGrabDuration,track:t.getTrack}}),e("div",{staticClass:"line-fit"},[e("VolumeSlider")],1)],1)])},E=[],A=(s("b93d"),function(){var t=this,e=t._self._c;return e("input",{ref:e=>t.inputRef=e,staticClass:"volume-range-input",attrs:{type:"range",min:"0",max:"1",step:"0.01",value:"1"}})}),R=[],N=(s("f702"),{data(){return{inputRef:null}},mounted(){this.inputRef.addEventListener("input",()=>{const t=this.inputRef.value;L.setVolume(t)})}}),j=N,q=Object(x["a"])(j,A,R,!1,null,null,null),U=q.exports,D=s("132d"),z=function(){var t=this,e=t._self._c;return e("div",{staticClass:"play-pause-container"},[t.onplay?e(D["a"],{on:{click:t.onClick}},[t._v(" mdi-pause ")]):e("button",{staticClass:"play-btn",on:{click:t.onClick}},[e("PlayIcon")],1)],1)},G=[],B=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(D["a"],[t._v("mdi-play")])},F=[],M=(s("c608"),{data(){return{}}}),H=M,V=Object(x["a"])(H,B,F,!1,null,null,null),K=V.exports,J=(s("c044"),{components:{PlayIcon:K},props:{onClick:{required:!0},onPlay:{required:!0}},data(){return{onplay:this.onPlay()}},mounted(){document.addEventListener("spl-play",()=>{this.onplay=!L.isPaused()}),document.addEventListener("spl-pause",()=>{this.onplay=!L.isPaused()})}}),W=J,Q=Object(x["a"])(W,z,G,!1,null,null,null),X=Q.exports,Y=function(){var t=this,e=t._self._c;return e("input",{ref:e=>t.inputRef=e,staticClass:"progress-input spl-progress",attrs:{type:"range",min:"0",max:"100",value:"0",step:"0.01"},on:{input:t.onInputHandler,change:t.onChange}})},Z=[],tt=(s("cc38"),{props:{onInput:{required:!0},onPlay:{required:!0},onGrabDuration:{required:!0},track:{required:!0}},data(){return{inputRef:void 0,onHover:!1}},mounted(){document.addEventListener("spl-play",()=>{(this.onPlay()||this.track.src==L.currentAudio.src)&&this.onInput(this.inputRef,this.hover)}),document.addEventListener("spl-pause",()=>{this.onPlay()||L.clearFallback()})},methods:{onChange:function(){this.onHover=!1},onInputHandler:function(t){this.onHover=!0,this.onGrabDuration(t.target.value)},hover:function(){return this.onHover}}}),et=tt,st=Object(x["a"])(et,Y,Z,!1,null,null,null),at=st.exports;function it(t,e){return t<0||t>100?"Le pourcentage doit être compris entre 0 et 100":e*t/100}function nt(t,e){if(t<0||e<=0)return"Les valeurs doivent être des nombres positifs";const s=t/e*100;return s}function ot(t){var e=Math.floor(t/60);e<10&&(e="0"+String(e));var s=Math.floor(t%60);return s<10&&(s="0"+String(s)),e+":"+s}var rt={components:{VolumeSlider:U,PlayPause:X,Progress:at},data(){return{onPlay:!1,progressBar:null,playInterval:void 0}},mounted(){document.addEventListener("keypress",t=>{"Space"===t.code&&(L.paused?L.play():L.pause())}),this.setEvent()},methods:{setEvent:function(){const t=this.$refs.timer;document.addEventListener("spl-play",(function(){this.playInterval=setInterval(()=>{const e=ot(L.getPlayingMinutes());t.textContent=String(e)},100)})),document.addEventListener("spl-pause",(function(){L.clearGlobalFallback(),clearInterval(this.playInterval)}))},setOnPlay:function(t){console.log("okoko",t)},play:function(){console.log(L.getAudioList()),L.play()},isPlaying:function(){return L.isPaused()},onGrabDuration:function(t){const e=it(t,L.getDuration());L.setCurrentTime(e)},onInputDuration:function(t,e){L.setGlobalFallback(()=>{e()||(t.value=nt(L.getCurrentTime(),L.getDuration()))})},getTrack:function(){return L.currentAudio}}},lt=rt,ct=Object(x["a"])(lt,O,E,!1,null,null,null),ut=ct.exports,dt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"pagination"},[e("button",{staticClass:"paging-btn paging-previous",attrs:{disabled:0===t.currentPage},on:{click:function(e){return t.changePage(t.currentPage-1)}}}),t._v(" "+t._s(t.currentPage)+" "),e("button",{staticClass:"paging-btn paging-next",attrs:{disabled:t.currentPage===t.totalPages},on:{click:function(e){return t.changePage(t.currentPage+1)}}}),t._v(" "+t._s(t.totalPage)+" ")])},pt=[],ht=(s("ba9b"),{props:{totalPage:{required:!0},itemsPerPage:{required:!0},currentPage:{required:!0}},mounted(){console.log("current page:",this.currentPage),console.log("total page:",this.totalPage)},computed:{totalPages(){return Math.ceil(this.totalPage/this.itemsPerPage)}},methods:{changePage(t){console.log("current page",this.currentPage),t>=0&&t<=this.totalPages&&this.$emit("changePage",t)}}}),mt=ht,ft=Object(x["a"])(mt,dt,pt,!1,null,null,null),gt=ft.exports,vt=(s("48fd"),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("ul",{staticClass:"grid audio-collection"},t._l(t.audios,(function(t){return e("AudioItem",{key:t.id,attrs:{track:t}})})),1)}),yt=[],kt=(s("acf2"),function(){var t=this,e=t._self._c;return e("li",{class:"audio-container audio-"+t.track.id},[e("img",{staticClass:"audio-image",class:"img-"+t.track.id,attrs:{src:t.track.imagesrc}}),e("p",{class:"audio-title audio-title-"+t.track.id},[t._v(t._s(t.track.name))]),e("div",{staticClass:"audio-header"},[e("a",{staticClass:"author-link",attrs:{href:"/profile?pseudo="+t.track.creator.pseudo,rel:"noopener noreferrer"}},[t._v(" "+t._s(t.track.creator.pseudo)+" ")]),e("div",{staticClass:"categories"},t._l(t.track.categories,(function(t){return e("GenreTag",{key:t.id,attrs:{text:t.name}})})),1)]),e("div",{staticClass:"audio-footer"},[e("div",{staticClass:"audio-action"},[e(D["a"],{attrs:{size:"22"},on:{click:t.showComments}},[t._v("mdi-message-text-outline")]),e(D["a"],{staticClass:"audio-action-item",attrs:{size:"22"},on:{click:t.like}},[t._v("mdi-star-outline")]),t._v(" "+t._s(t.track.likes.count)+" ")],1),e("AddToPlaylistDialog",{attrs:{track:t.track}})],1)])}),Ct=[];class Pt{async like(t){const e=await k.post("/like",{modelid:t});return e.data}async library(t){const e=await k.get("/library?userPseudo="+t);return e.data}async plailyst(t){const e=await k.get("playlists?userPseudo="+t);return e.data}async update(t){const e=await k.patch("/track",t);return e.data}async delete(t){const e=await k.delete("/track/"+t);return e.data}}var _t=new Pt,bt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"button genre-tag",on:{onClick:t.clickHandler}},[t._v(t._s(t.text))])},wt=[],It=(s("03e2"),{props:{text:{required:!0},onClick:{required:!1}},methods:{clickHandler:function(){this.onClick?this.onClick():console.log("Todo")}}}),xt=It,Tt=Object(x["a"])(xt,bt,wt,!1,null,null,null),St=Tt.exports,$t=(s("30d9"),function(){var t=this,e=t._self._c;return e("div",[t.$store.state.user?e(D["a"],{on:{click:t.toggleDialog}},[t._v("mdi-playlist-plus")]):t._e(),t.openDialog?e("div",{staticClass:"dialog-layout",on:{click:t.layoutClick}},[e("div",{staticClass:"dialog-content",attrs:{id:"playlist-dialog"}},[e("p",{staticClass:"dialog-title"},[t._v("Playlists")]),e("div",{staticClass:"separator"}),e("PlaylistList",{attrs:{playlists:t.playlists,track:t.track,updateTrackInPlaylist:t.updateTrackInPlaylist}})],1)]):t._e()],1)}),Lt=[];class Ot{static async playlists(t){const e=await k.get("playlists?userPseudo="+t);return e.data}static async create(t="Nom par défaut"){const e=await k.post("/playlist",{name:t});return e.data}static async delete(t){const e=await k.delete("/playlist/"+t);return e.data}static async update(t){const e=await k.patch("/playlist",t);return e.data}static async appendTrack(t,e){const s=await k.post("/playlist/add-audio",{plailystid:t,trackid:e});return s.data}static async removeTrack(t,e){const s=await k.delete("/playlist/"+t+"/"+e,{plailystid:t,trackid:e});return s.data}}var Et=Ot,At=(s("c922"),function(){var t=this,e=t._self._c;return e("span",t._l(t.playlists,(function(s){return e("div",{key:s.id},[e("PlaylistListItem",{attrs:{playlist:s,track:t.track,updateTrackInPlaylist:t.updateTrackInPlaylist}})],1)})),0)}),Rt=[],Nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"line justify-between"},[e("label",{attrs:{for:"playlist-"+t.playlist.id}},[t._v(t._s(t.playlist.name))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.inPlaylist,expression:"inPlaylist"}],ref:"inputRef",attrs:{id:"playlist-"+t.playlist.id,type:"checkbox"},domProps:{checked:Array.isArray(t.inPlaylist)?t._i(t.inPlaylist,null)>-1:t.inPlaylist},on:{click:t.onClick,change:function(e){var s=t.inPlaylist,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=null,o=t._i(s,n);a.checked?o<0&&(t.inPlaylist=s.concat([n])):o>-1&&(t.inPlaylist=s.slice(0,o).concat(s.slice(o+1)))}else t.inPlaylist=i}}})])},jt=[],qt={props:{playlist:{required:!0},track:{required:!0},updateTrackInPlaylist:{required:!0}},data(){return{inPlaylist:!1,refInput:void 0,bufferTrack:void 0}},async mounted(){this.bufferTrack=this.track,this.inPlaylist=await this.isInPlaylist()},methods:{isInPlaylist:async function(){const t=await this.playlist.tracks.rows.find(t=>t.id==this.bufferTrack.id);return void 0!=t},onClick:async function(){if(this.inPlaylist){this.inPlaylist=!1;const t=await Et.removeTrack(this.playlist.id,this.bufferTrack.id);t||console.log("Une erreur et survenue lors de l'ajout d'un track à une playlist"),this.updateTrackInPlaylist(this.inPlaylist,t)}else{this.inPlaylist=!0;const t=await Et.appendTrack(this.playlist.id,this.bufferTrack.id);t||console.log("Une erreur et survenue lors de l'ajout d'un track à une playlist"),this.updateTrackInPlaylist(this.inPlaylist,t)}}}},Ut=qt,Dt=Object(x["a"])(Ut,Nt,jt,!1,null,null,null),zt=Dt.exports,Gt={props:{playlists:{required:!0},track:{required:!0},updateTrackInPlaylist:{required:!0}},components:{PlaylistListItem:zt}},Bt=Gt,Ft=Object(x["a"])(Bt,At,Rt,!1,null,null,null),Mt=Ft.exports,Ht={props:{track:{required:!0}},data(){return{openDialog:!1,playlists:[],clickOutside:!0,refContent:void 0}},methods:{setRefContent:async function(){if(!this.refContent)return;const t=t=>this.clickOutside=t;this.refContent.addEventListener("mouseover",()=>t(!1)),this.refContent.addEventListener("mouseout",()=>t(!0)),this.refContent.addEventListener("focus",()=>t(!1)),this.refContent.addEventListener("focusin",()=>t(!1)),this.refContent.addEventListener("focusout",()=>t(!1)),await this.getPlaylist()},getPlaylist:async function(){const t=await Et.playlists(this.$store.state.user.pseudo);this.playlists=t},toggleDialog:function(){this.openDialog?this.openDialog=!1:(this.openDialog=!0,setTimeout(async()=>{this.refContent=document.getElementById("playlist-dialog"),await this.setRefContent()},0))},layoutClick:function(){this.clickOutside&&(this.openDialog=!1)},updateTrackInPlaylist:function(t,e){const s=this.playlists.findIndex(t=>t.id==e.playlistid);if(-1==s)return console.log("ERROR playlist non existante");if(t)this.playlists[s].tracks.rows.push({id:e.audioid});else{const t=this.playlists[s].tracks.rows.findIndex(t=>t.id==e.audioid);if(-1==t)return console.log("ERROR l'audio na pas été trouver dans la playlist");delete this.playlists[s].tracks.rows[t]}}},components:{PlaylistList:Mt}},Vt=Ht,Kt=Object(x["a"])(Vt,$t,Lt,!1,null,null,null),Jt=Kt.exports,Wt={name:"discover-item-list",components:{GenreTag:St,AddToPlaylistDialog:Jt},props:{track:{required:!0}},async mounted(){const t=document.getElementsByClassName("img-"+this.track.id)[0];t.addEventListener("click",this.play);const e=document.getElementsByClassName("audio-container audio-"+this.track.id)[0],s=document.getElementsByClassName("audio-title-"+this.track.id)[0];e.addEventListener("mouseover",()=>{s.classList.add("scrollingText")}),e.addEventListener("mouseover",()=>{s.classList.remove("scrollingText")})},methods:{play:async function(){await L.play(this.track.src)},pause:function(){L.pause()},showComments:function(){this.$store.commit("setCommentsPanelAudio",this.track),this.$store.commit("toggleCommentsPanel")},like:async function(){const t=await _t.like(this.track.id);t[1]?this.track.likes.count+=1:this.track.likes.count-=1}}},Qt=Wt,Xt=Object(x["a"])(Qt,kt,Ct,!1,null,null,null),Yt=Xt.exports,Zt={name:"audios-discover-collection",components:{AudioItem:Yt},props:{audios:{required:!0}}},te=Zt,ee=Object(x["a"])(te,vt,yt,!1,null,null,null),se=ee.exports,ae=function(){var t=this,e=t._self._c;return t.$store.state.commentsPanel.open||null==t.$store.state.commentsPanel.audio.id?t._e():e("section",{attrs:{id:"comments-panel"}},[e("section",{staticClass:"comments-panel-container"},[e("header",{staticClass:"comments-header"},[e("p",{staticClass:"comments-header-title"},[t._v(t._s(t.$store.state.commentsPanel.audio.name))]),e(D["a"],{staticClass:"close-comment-panel",on:{click:t.toggleCommentsPanel}},[t._v("mdi-close")])],1),e("span",{staticClass:"separator"}),e("div",{staticClass:"comments-content"},t._l(t.comments,(function(s){return e("div",{key:s.id},[e("CommentItem",{attrs:{comment:s,setReplyTo:t.setReplyTo,getInputRef:t.getInputRef}})],1)})),0),e("footer",{staticClass:"comments-footer"},[null!=t.$store.state.user?e("CommentInput",{attrs:{setInputRef:t.setInputRef,getReplyTo:t.getReplyTo,audioid:t.audioid,placeholder:"Entrer un commentaire"},on:{pushComment:t.pushComment}}):e("p",{staticClass:"comments-footer-text"},[t._v("Connectez-vous pour commenter")])],1)])])},ie=[];s("09c9");class ne{async getCommentForAudio(t){const e=await k.get("/comments/"+t);return e.data}async postComment(t,e){const s=await k.post("/comment",{audioid:t,content:e});return s.data}async replyTo(t,e,s){const a=await k.post("/comment",{audioid:t,content:s,responseOf:e});return a.data}async deleteComment(t){const e=await k.delete("/comment/"+t);return e.data}async singalComment(t){const e=await k.post("/signal/comment/"+t);return e.data}}var oe=new ne,re=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment-item"},[e("div",{staticClass:"comment-informations"},[e("img",{attrs:{src:t.authorPicture(),alt:""}}),e("p",{staticClass:"cursor-pointer",on:{click:t.goToAuthor}},[t._v(t._s(t.comment.author.pseudo))])]),e("div",{staticClass:"comment-content"},[e("p",{staticClass:"comment-text"},[t._v(t._s(t.comment.content))]),null!=t.$store.state.user?e("div",{staticClass:"comment-actions"},[e(D["a"],{attrs:{size:"22"},on:{click:t.reply}},[t._v("mdi-reply")]),t.comment.signaled?e(D["a"],{staticClass:"comment-alert active",attrs:{size:"20"},on:{click:t.signalComment}},[t._v("mdi-alert-circle-outline")]):e(D["a"],{staticClass:"comment-alert",attrs:{size:"20"},on:{click:t.signalComment}},[t._v("mdi-alert-circle-outline")])],1):t._e()])])},le=[],ce=(s("ea26"),{props:{comment:{required:!0},setReplyTo:{reuqired:!0},getInputRef:{required:!0}},data(){return{inReply:!1}},mounted(){console.log(this.comment.author)},methods:{signalComment:async function(){const t=await oe.singalComment(this.comment.id);t[1]?this.comment.signaled+=1:this.comment.signaled-=1},goToAuthor:function(){this.$router.push("/profile?pseudo="+this.comment.author.pseudo)},authorPicture(){let t;return window.location.host.includes("localhost")&&(t="https://localhost:3000"),t+"/api/user-picture?pseudo="+this.comment.author.pseudo},reply:function(){this.setReplyTo(this.comment.id),this.getInputRef().focus()}}}),ue=ce,de=Object(x["a"])(ue,re,le,!1,null,null,null),pe=de.exports,he=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment-input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],ref:"commentInput",attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.input},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.postComment.apply(null,arguments)},input:function(e){e.target.composing||(t.input=e.target.value)}}})])},me=[],fe=(s("19da"),{props:{audioid:{required:!0},getReplyTo:{required:!0},setInputRef:{required:!0},placeholder:{required:!1}},data(){return{input:""}},mounted(){this.setInputRef(this.$refs.commentInput)},methods:{postComment:async function(){if(""!=this.input&&!isNaN(this.audioid)){let t;t=this.getReplyTo()?await oe.replyTo(this.audioid,this.getReplyTo().responseOf,this.input):await oe.postComment(this.audioid,this.input),this.$emit("pushComment",t)}}}}),ge=fe,ve=Object(x["a"])(ge,he,me,!1,null,null,null),ye=ve.exports,ke={components:{CommentItem:pe,CommentInput:ye},props:{audioid:{required:!0}},watch:{audioid:function(){this.getComments()}},data(){return{comments:[],replyTo:void 0,inputRef:void 0}},mounted(){0==!this.audioid&&this.getComments()},methods:{getComments:async function(){this.comments=await oe.getCommentForAudio(this.audioid)},toggleCommentsPanel:function(){this.$store.commit("toggleCommentsPanel")},pushComment:function(t){console.log("comment"),this.comments={...this.comments,comment:t}},getReplyTo:function(){return this.replyTo},setReplyTo:function(t){this.replyTo={responseOf:t}},getInputRef:function(){return this.inputRef},setInputRef:function(t){this.inputRef=t}}},Ce=ke,Pe=Object(x["a"])(Ce,ae,ie,!1,null,null,null),_e=Pe.exports,be={name:"discover",components:{SimpleAudioPlayerComponent:ut,CommentsPanel:_e,Searchbar:S,AudioList:se,GenreTag:St,Paging:gt},data(){return{audios:{currentPage:0,datas:[],totalItems:0,totalPages:0},page:"artists",searchKeyword:"",currentPageList:0,dataLoaded:!1}},async mounted(){await this.getAudios(),this.dataLoaded=!0;const t=this.audios.datas.map(t=>t.src);L.setAudioList(t),console.log(L.getAudioList())},methods:{onPageChange:function(t){console.log("on change  page"),this.audios.currentPage=t,this.getAudios()},getAudios:async function(){this.audios=await P.all(this.audios.currentPage)},play:async function(){await L.play()},searchAudio:async function(t){console.log(t),""==t?this.getAudios():this.audios=await P.search(t)}}},we=be,Ie=Object(x["a"])(we,h,m,!1,null,null,null),xe=Ie.exports,Te=function(){var t=this,e=t._self._c;return t.user?e("div",[e("section",{attrs:{id:"profile-head"}},[e("ProfileHead",{attrs:{user:t.user,isLogedInProfile:t.isLogedInProfile}})],1),e("section",{attrs:{id:"profile-tab"}},[e("div",{staticClass:"line gap-5"},[t.isLogedInProfile()?e("p",{staticClass:"profile-view-selector",on:{click:()=>t.changeView("sessions")}},[t._v(" Sessions ")]):t._e(),e("p",{staticClass:"profile-view-selector",on:{click:()=>t.changeView("tracks")}},[t._v("Tracks")]),e("p",{staticClass:"profile-view-selector",on:{click:()=>t.changeView("playlist")}},[t._v("Playlist")])]),e("div",["sessions"==t.viewname&&t.isLogedInProfile()?e("SessionsList",{attrs:{sessionsProps:t.sessions,"is-my-profile":t.isLogedInProfile()}}):t._e(),"tracks"==t.viewname?e("div",[e("TracksList"),e("SimplePlayer")],1):t._e(),"playlist"==t.viewname?e("Playlist"):t._e()],1)])]):t._e()},Se=[],$e=function(){var t=this,e=t._self._c;return e("div",{staticClass:"profile-head-container"},[t._m(0),e("div",{staticClass:"profile-head-lines"},[e("div",{staticClass:"line justify-between"},[e("div",{staticClass:"line-left"},[e("h2",[t._v(t._s(t.user.pseudo))])]),e("div",{staticClass:"line-right"},[t.isLogedInProfile()?t._e():e("button",[t._v("Suivre")])])]),e("div",{staticClass:"line justify-between"},[e("div",{staticClass:"line-left"},[e("div",{staticClass:"line"}),e("div",{staticClass:"line"},[e("p",[t._v("Production Total: "+t._s(t.user.totalProductions))])])]),e("div",{staticClass:"line-right"},[e("span",[t._v("followers: "+t._s(t.user.followers.followingMe.count)+" ")]),e("span",[t._v("suivis: "+t._s(t.user.followers.IFollow.count)+" ")])])])])])},Le=[function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"profile-head-img-container",profilePictureRef:"{profilePictureRef}"}},[e("img",{attrs:{src:"https://images.pexels.com/photos/3693108/pexels-photo-3693108.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:""}})])}],Oe=(s("d818"),{props:{user:{required:!0},isLogedInProfile:{required:!0}},data(){return{name:"Name"}},mounted(){console.log(this.isLogedInProfile())}}),Ee=Oe,Ae=Object(x["a"])(Ee,$e,Le,!1,null,null,null),Re=Ae.exports;s("f797");class Ne{async get(t){const e=await k.get("/user/"+t).catch(t=>{console.log(t)});return!!e&&e.data}async profile(t){const e=await k.get("/profile?pseudo="+t).catch(t=>{console.log(t)});return!!e.data&&e.data}async update(t,e){const s=await k.patch("/user/"+t,e);return s.data}async register(t){const e=await k.patch("/auth",t).catch(t=>t.response);return 200!=e.status?(window.App.$store.commit("push_alert",{message:e.data.message,type:"info"}),!1):e.data}async login(t){const e=await k.post("/auth",t).catch(t=>t.response);return 200!=e.status?(window.App.$store.commit("push_alert",{message:e.data.message,type:"info"}),!1):e.data}}var je=new Ne,qe=function(){var t=this,e=t._self._c;return e("section",{staticClass:"profile-content-section"},[e("header",{staticClass:"profile-content-header"},[e("Searchbar",{attrs:{onKeyPressEnter:"sz",placeholder:"Recherchez une session",onInput:t.search}}),e("button",{on:{click:t.createSession}},[t._v("Créer")])],1),e("div",{staticClass:"profile-content-content"},t._l(t.sessions,(function(t){return e("div",{key:t.id},[e("SessionItem",{attrs:{session:t}})],1)})),0)])},Ue=[];class De{static async all(){const t=await k.get("sessions");return t.data}static async one(t){const e=await k.get("session/"+t);return e.data}static async create(t){const e=await k.post("session",t);return e.data}static async update(t){const e=await k.patch("session",t);return e.data}static async search(t){const e=await k.post("/search/sessions",{query:t});return e.data}static async delete(t){const e=await k.delete("/session/"+t);return e.data}}var ze=function(){var t=this,e=t._self._c;return e("div",{staticClass:"session-item"},[e("div",{staticClass:"session-img-container"},[e("img",{staticClass:"session-img",attrs:{src:"https://images.pexels.com/photos/3693108/pexels-photo-3693108.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"session-image"}})]),e("div",{staticClass:"session-item-content"},[e("div",{staticClass:"session-item-line-top"},[e("p",[t._v(t._s(t.session.session_name))]),e("p",[t._v("tracks: "+t._s(t.session.tracksCount))]),e("p",[t._v(t._s(null==t.session.mixed?"aucun mix":t.session.mixed))]),e("div",{staticClass:"session-item-actions"},[e("button",{staticClass:"open-session-btn",on:{click:t.open}},[t._v("ouvrir")]),e(D["a"],{attrs:{color:"red",size:20},on:{click:t.deleteSession}},[t._v("mdi-trash-can")])],1)]),e("div",{staticClass:"session-item-line-bottom"},[e("p",{staticClass:"line-fit"},[t._v("public: "),e("SwitchToggler",{attrs:{checked:t.session.public,onChange:t.updatePublic}})],1),e("p",[t._v("créer: "+t._s(t.session.createdAt.substring(0,10))+" ")])])])])},Ge=[],Be=(s("b282"),function(){var t=this,e=t._self._c;return e("label",{staticClass:"switch"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:this.checkedValue},on:{change:t.onChangeHandler}}),e("span",{staticClass:"slider round"})])}),Fe=[],Me=(s("fd3a"),{props:{checked:{required:!0},onChange:{required:!0}},data(){return{checkedValue:!1}},mounted(){console.log(this.checked),this.checkedValue=this.checked,console.log("switch mounted")},methods:{onChangeHandler:async function(){this.checkedValue=!this.checkedValue,await this.onChange(this.checkedValue)}}}),He=Me,Ve=Object(x["a"])(He,Be,Fe,!1,null,null,null),Ke=Ve.exports,Je={components:{SwitchToggler:Ke},props:{session:{required:!0}},methods:{open:function(){this.$store.commit("setCurrentSession",this.session),this.$router.push("/studio")},updatePublic:async function(t){console.log("okok",t);const e=await De.update({sessionid:this.session.id,field:"public",value:t});console.log(e)},deleteSession:async function(){const t=await De.delete(this.session.id);console.log(t)}}},We=Je,Qe=Object(x["a"])(We,ze,Ge,!1,null,null,null),Xe=Qe.exports,Ye=(s("7f51"),{components:{Searchbar:S,SessionItem:Xe},props:{sessionsProps:{required:!0}},data(){return{sessions:[]}},mounted(){this.getSessions()},methods:{getSessions:async function(){const t=await De.all();if(null==this.$store.state.currentSession.id)this.sessions=t.datas;else{const e=t.datas.findIndex(t=>t.id==this.$store.state.currentSession.id),s=t.datas[e];void 0!=s&&(t.datas.splice(e,1),t.datas.unshift(s)),this.sessions=t.datas}},createSession:async function(){const t=await De.create({name:"Session 1"});this.$store.commit("setCurrentSession",t),this.$router.push("/studio")},search:async function(t){if(""==t)return this.getSessions();const e=await De.search(t);console.log("Searched sessions:",e),this.sessions=e.datas}}}),Ze=Ye,ts=Object(x["a"])(Ze,qe,Ue,!1,null,null,null),es=ts.exports,ss=function(){var t=this,e=t._self._c;return e("section",{staticClass:"profile-content-section"},[e("header",{staticClass:"profile-content-header"},[e("Searchbar",{attrs:{onKeyPressEnter:"sz",placeholder:"Recherchez une session",onInput:t.search}}),e("button",{on:{click:t.uploadTrack}},[t._v("Importer")])],1),e("div",{staticClass:"profile-content-content"},t._l(t.tracks,(function(s){return e("div",{key:s.id},[e("TrackItem",{attrs:{track:s,removeTrack:t.removeTrack}})],1)})),0)])},as=[],is=function(){var t=this,e=t._self._c;return e("div",{staticClass:"track-item"},[e("div",{staticClass:"track-img-container"},[e("img",{staticClass:"track-img",attrs:{src:t.track.imagesrc,alt:"track-image"}})]),e("div",{staticClass:"track-item-content"},[e("div",{staticClass:"track-item-line-top"},[e("div",{staticClass:"track-item-name-actions"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.trackName,expression:"trackName"}],ref:"refNameInput",staticClass:"track-name-input",attrs:{type:"text",disabled:""},domProps:{value:t.trackName},on:{input:function(e){e.target.composing||(t.trackName=e.target.value)}}})]),e("div",{staticClass:"line-fit"},[e(D["a"],{attrs:{size:18,color:"red"},on:{click:t.deleteTrack}},[t._v("mdi-trash-can")]),e("p",{staticClass:"line-fit"},[e(D["a"],{staticClass:"audio-action-item",attrs:{size:"22"}},[t._v("mdi-star-outline")]),t._v(" "+t._s(t.track.likes.count)+" ")],1)],1)]),e("div",{staticClass:"track-item-line-center"},[e("PlayProgress",{attrs:{audioUrl:t.track.src,onPlay:t.Playing,onClickPlay:t.play,onInputDuration:t.onInputDuration,"on-grab-duration":t.onGrabDuration,track:t.track}})],1),e("div",{staticClass:"track-item-line-bottom"},[e("div",[t.$store.state.userProfile&&t.$store.state.userProfile.isMyProfile?e("p",{staticClass:"line-fit"},[t._v(" public: "),e("SwitchToggler",{attrs:{checked:t.track.public,onChange:t.updatePublic}})],1):t._e()]),e("p",[t._v("créer: "+t._s(t.track.createdAt.substring(0,10))+" ")])])])])},ns=[],os=(s("772f"),function(){var t=this,e=t._self._c;return e("label",{staticClass:"switch"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.checked},on:{change:t.onChangeHandler}}),e("span",{staticClass:"slider round"})])}),rs=[],ls=(s("c054"),{props:{checked:{required:!0},onChange:{required:!0}},methods:{onChangeHandler:function(){this.checked?this.checked=!1:this.checked=!0,this.onChange(this.checked)}}}),cs=ls,us=Object(x["a"])(cs,os,rs,!1,null,null,null),ds=us.exports,ps=function(){var t=this,e=t._self._c;return e("div",{staticClass:"play-progress"},[e("PlayPause",{attrs:{"on-click":t.onClickPlay,"on-play":t.onPlay}}),e("Progress",{attrs:{"on-input":t.onInputDuration,"on-play":t.onPlay,"on-grab-duration":t.onGrabDuration,track:t.track}})],1)},hs=[],ms=(s("fb3a"),{components:{Progress:at,PlayPause:X},props:{onPlay:{required:!0},onClickPlay:{required:!0},onInputDuration:{required:!0},onGrabDuration:{required:!0},track:{required:!0}}}),fs=ms,gs=Object(x["a"])(fs,ps,hs,!1,null,null,null),vs=gs.exports,ys={components:{SwitchToggler:ds,PlayProgress:vs},props:{track:{required:!0},removeTrack:{required:!0}},data(){return{onPlay:!1,trackName:"defaultnamùe",onUpdate:!1}},mounted(){const t=this.track;this.trackName=this.track.name;const e=t=>this.onPlay=t;document.addEventListener("spl-play",()=>{t.src==L.getCurrentAudio().src&&e(!0)}),document.addEventListener("spl-play",()=>{t.src==L.getCurrentAudio().src&&e(!1)})},methods:{play:function(){this.onPlay?this.onPlay=!1:this.onPlay=!0,L.play(this.track.src,this.track)},updatePublic:async function(t){console.log("public upate");const e=await _t.update({trackid:this.track.id,fields:"public",datas:String(t)});console.log(e)},updateTrackName:async function(){this.track.name!=this.trackName&&console.log("update"),this.onUpdate=!this.onUpdate,this.onUpdate?(this.$refs.refNameInput.disabled=!1,this.$refs.refNameInput.focus()):this.$refs.refNameInput.disabled=!0},deleteTrack:async function(){const t=await _t.delete(this.track.id);if(!t)return console.log("Error lors de la suppression d'un track");await this.removeTrack(t)},onInputDuration:function(t,e){L.setFallback(()=>{e()||(t.value=nt(L.getCurrentTime(),L.getDuration()))})},onGrabDuration:function(t){const e=it(t,L.getDuration());L.setCurrentTime(e)},Playing:function(){return console.log("Playing",L.getCurrentAudio().src==this.track.src,this.onPlay),this.onPlay&&L.getCurrentAudio().src==this.track.src}}},ks=ys,Cs=Object(x["a"])(ks,is,ns,!1,null,null,null),Ps=Cs.exports,_s=(s("22cf"),{components:{Searchbar:S,TrackItem:Ps},data(){return{tracks:[]}},mounted(){this.getTracks()},methods:{getTracks:async function(){const t=this.$store.state.userProfile?this.$store.state.userProfile.user.pseudo:void 0,e=await _t.library(t);this.tracks=e,L.setAudioList(e)},search:async function(t){if(""==t)return this.getTracks();const e=await De.search(t);this.tracks=e.datas},uploadTrack:function(){},removeTrack:async function(t){const e=this.tracks.findIndex(e=>e.id==t);if(-1==e)return console.log("ERROR le track na pas été trouver");this.tracks=this.tracks.filter(e=>e.id!=t)}}}),bs=_s,ws=Object(x["a"])(bs,ss,as,!1,null,null,null),Is=ws.exports,xs=function(){var t=this,e=t._self._c;return e("section",{staticClass:"profile-content-section"},[e("header",{staticClass:"profile-content-header"},[e("Searchbar",{attrs:{onKeyPressEnter:"search",placeholder:"Recherchez une session",onInput:t.search}}),e("button",{on:{click:t.createPlaylistOpenDialog}},[t._v("Créer")]),e("div",{staticClass:"dialog-input-container",class:t.onCreate?"active":""},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.playlistName,expression:"playlistName"}],ref:"newPlayListNameInput",staticClass:"dialog-input",attrs:{type:"text",placeholder:"Nom de la nouvelle playlist."},domProps:{value:t.playlistName},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleEnterOfCreateInput.apply(null,arguments)},input:function(e){e.target.composing||(t.playlistName=e.target.value)}}})])],1),e("div",{staticClass:"profile-content-content"},t._l(t.playlists,(function(s){return e("div",{key:s.id},[e("PlaylistItem",{attrs:{playlist:s,removePlaylist:t.removePlaylist}})],1)})),0)])},Ts=[],Ss=(s("e991"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"playlist-item"},[e("div",{staticClass:"playlist-item-head"},[e("div",{staticClass:"line-fit edit-name"},[t.onUpdate?e(D["a"],{staticStyle:{"margin-top":"6px"},attrs:{size:16},on:{click:()=>t.onUpdate=!1}},[t._v("mdi-check")]):e(D["a"],{staticStyle:{"margin-top":"6px"},attrs:{size:16},on:{click:t.updatePlaylistName}},[t._v("mdi-pencil")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.playlistName,expression:"playlistName"}],ref:"playlistInputName",staticClass:"edit-name-input",attrs:{type:"text",disabled:""},domProps:{value:t.playlistName},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(()=>t.onUpdate=!1).apply(null,arguments)},input:function(e){e.target.composing||(t.playlistName=e.target.value)}}})],1),e("div",{staticClass:"line-fit"},[e("p",[t._v(t._s(t.playlist.tracks.count)+" titres -")]),e("p",{staticClass:"line-fit"},[t._v(" public: "),e("SwitchToggler",{attrs:{checked:t.playlist.public,onChange:t.updatePublic}}),t._v(" - ")],1),e(D["a"],{attrs:{color:"red",size:18},on:{click:t.deletePlaylist}},[t._v("mdi-trash-can")])],1),e("div",{staticClass:"line-fit"},[t.collapsed?e(D["a"],{on:{click:()=>t.collapsed=!1}},[t._v("mdi-chevron-down")]):e(D["a"],{on:{click:()=>t.collapsed=!0}},[t._v("mdi-chevron-up")])],1)]),e("div",{staticClass:"playlist-collapse",class:t.collapsed?"":"active"},t._l(t.playlist.tracks.rows,(function(t){return e("div",{key:t.id},[e("PlaylistTrackItem",{attrs:{track:t}})],1)})),0)])}),$s=[],Ls=(s("59a2"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"playlist-track-item"},[e("div",{staticClass:"playlist-track-img-container"},[e("img",{staticClass:"playlist-track-img",attrs:{src:t.track.imagesrc,alt:"playlist-track-image"}})]),e("div",{staticClass:"playlist-track-item-content"},[e("div",{staticClass:"playlist-track-item-line-top"},[e("p",[t._v(t._s(t.track.name))]),e("p",[e(D["a"],{staticClass:"audio-action-item",attrs:{size:"16"}},[t._v("mdi-star-outline")]),t._v(" "+t._s(t.track.likes.count)+" ")],1)]),e("div",{staticClass:"playlist-track-item-line-center"},[e("PlayProgress",{attrs:{audioUrl:t.track.src,onPlay:t.Playing,onClickPlay:t.play,onInputDuration:t.onInputDuration,"on-grab-duration":t.onGrabDuration,track:t.track}}),e(D["a"],{staticClass:"btn-icon",attrs:{size:18}},[t._v("mdi-trash-can")])],1),e("div",{staticClass:"playlist-track-item-line-bottom"},[e("div",{staticClass:"author-picture",on:{click:t.openAuthor}},[e("img",{attrs:{src:t.track.creator.picture,alt:""}}),e("p",[t._v(t._s(t.track.creator.pseudo)+" ")])])])])])}),Os=[],Es=(s("8988"),{components:{PlayProgress:vs},props:{track:{required:!0}},data(){return{onPlay:!1}},mounted(){const t=this.track,e=t=>this.onPlay=t;document.addEventListener("spl-play",()=>{t.src==L.getCurrentAudio().src&&e(!0)}),document.addEventListener("spl-play",()=>{t.src==L.getCurrentAudio().src&&e(!1)})},methods:{play:function(){this.onPlay?this.onPlay=!1:this.onPlay=!0,L.play(this.track.src,this.track)},updatePublic:function(){},onInputDuration:function(t,e){L.setFallback(()=>{e()||(t.value=nt(L.getCurrentTime(),L.getDuration()))})},onGrabDuration:function(t){const e=it(t,L.getDuration());L.setCurrentTime(e)},Playing:function(){return console.log("Playing",L.getCurrentAudio().src==this.track.src,this.onPlay),this.onPlay&&L.getCurrentAudio().src==this.track.src},openAuthor:function(){window.location.href="/profile?pseudo="+this.track.creator.pseudo}}}),As=Es,Rs=Object(x["a"])(As,Ls,Os,!1,null,null,null),Ns=Rs.exports,js={components:{PlaylistTrackItem:Ns,SwitchToggler:Ke},props:{playlist:{required:!0},removePlaylist:{required:!0}},data(){return{collapsed:!0,collapseElement:void 0,playlistName:void 0,onUpdate:!1}},watch:{async onUpdate(t){this.$refs.playlistInputName.disabled=!this.$refs.playlistInputName.disabled,t&&this.$refs.playlistInputName.focus(),t||await Et.update({playlistid:this.playlist.id,field:"name",value:this.playlistName})}},mounted(){this.playlistName=this.playlist.name},methods:{updatePlaylistName:async function(){this.onUpdate=!this.onUpdate},updatePublic:async function(t){const e=await Et.update({playlistid:this.playlist.id,field:"public",value:String(t)});console.log(e)},deletePlaylist:async function(){const t=await Et.delete(this.playlist.id);console.log(t),this.removePlaylist(t.id)}}},qs=js,Us=Object(x["a"])(qs,Ss,$s,!1,null,null,null),Ds=Us.exports,zs={components:{Searchbar:S,PlaylistItem:Ds},data(){return{playlists:[],onCreate:!1,playlistName:"Nom par défaut"}},mounted(){this.getPlaylists(),this.$refs.newPlayListNameInput.addEventListener("focusout",()=>{this.onCreate=!1})},methods:{getPlaylists:async function(){const t=this.$store.state.userProfile?this.$store.state.userProfile.user.pseudo:void 0,e=await _t.plailyst(t);this.playlists=e},search:function(){console.log("okokok search")},createPlaylistOpenDialog:function(){console.log("onCreate:",this.onCreate),this.onCreate=!this.onCreate,this.$refs.newPlayListNameInput.focus()},handleEnterOfCreateInput:async function(){const t=await Et.create(this.playlistName);this.playlists.push(t),this.playlistName="Nom par défaut",this.onCreate=!1},removePlaylist(t){const e=this.playlists.findIndex(e=>e.id==t);if(-1==e)return console.log("WARNING: la playlist à supprimer ne fait pas parti des playlist charger localement");this.playlists=this.playlists.filter(e=>e.id!=t)}}},Gs=zs,Bs=Object(x["a"])(Gs,xs,Ts,!1,null,null,null),Fs=Bs.exports,Ms={name:"profile",components:{ProfileHead:Re,SessionsList:es,TracksList:Is,SimplePlayer:ut,Playlist:Fs},data(){return{viewname:"sessions",user:void 0,sessions:[],tracks:[],playlist:[]}},mounted(){const t=new URL(document.location).searchParams,e=t.get("pseudo");null==e&&null==this.$store.state.user&&this.$router.push("/"),this.getUserInformations()},methods:{getUserInformations:async function(){const t=new URL(document.location).searchParams;let e=t.get("pseudo");if(!this.user&&!this.$store.state.user&&!e)return this.$router.push("/");e||(e=this.$store.state.user.pseudo),this.user=await je.profile(e),this.sessions=this.user.sessions,this.tracks=this.user.tracks,this.playlists=this.user.playlists,this.isLogedInProfile()?this.viewname="sessions":this.viewname="tracks",console.log(this.viewname),this.$store.commit("setUserProfile",{user:this.user,isMyProfile:this.isLogedInProfile()}),console.log("Is my profile:",this.isLogedInProfile(),this.$store.state.userProfile)},changeView:function(t){this.viewname=t},isLogedInProfile:function(){const t=new URL(document.location).searchParams,e=t.get("pseudo");return this.$store.state.user||e?!(!this.$store.state.user||this.$store.state.user.pseudo!=e)||!(e||!this.$store.state.user):this.$router.push("/")}}},Hs=Ms,Vs=Object(x["a"])(Hs,Te,Se,!1,null,null,null),Ks=Vs.exports,Js=function(){var t=this,e=t._self._c;return e("section",{attrs:{id:"studio"}})},Ws=[],Qs={data(){return{sessionName:"Session name",tracks:[]}},mounted(){console.log(this.$store.state.currentSession)},methods:{getSession:function(){}}},Xs=Qs,Ys=Object(x["a"])(Xs,Js,Ws,!1,null,null,null),Zs=Ys.exports,ta=function(){var t=this,e=t._self._c;return e("div",{staticClass:"auth-layout"},[e("div",{staticClass:"auth-card"},[e("header",{staticClass:"auth-title"},[t._v("S'enregistrer")]),e("div",{staticClass:"auth-content"},[e("div",{staticClass:"w-full"},[e("label",{attrs:{for:""}},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"auth-input",attrs:{type:"text"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),e("div",{staticClass:"w-full"},[e("label",{attrs:{for:""}},[t._v("Pseudo")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pseudo,expression:"pseudo"}],staticClass:"auth-input",attrs:{type:"text"},domProps:{value:t.pseudo},on:{input:function(e){e.target.composing||(t.pseudo=e.target.value)}}})]),e("div",{staticClass:"w-full"},[e("label",{attrs:{for:""}},[t._v("Mot de passe")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"auth-input",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])]),e("div",{staticClass:"auth-actions"},[e("button",{staticClass:"login-button",on:{click:t.goToLogin}},[t._v("Se connecter")]),e("button",{staticClass:"register-button",on:{click:t.register}},[t._v("S'enregistrer")])])])])},ea=[],sa=(s("be3f"),{data(){return{pseudo:void 0,email:void 0,password:void 0}},methods:{register:async function(){if(void 0==this.password&&void 0==this.email&&void 0==this.pseudo)return alert("Les champs sont requis !");const t=await je.register({email:this.email,pseudo:this.pseudo,password:this.password});if(!t)return console.log("ERROR: Une erreur est survenue lors de la connexion");this.$store.commit("setUser",t.user),this.$store.commit("setToken",t.token),this.$router.push("profile")},goToLogin:function(){this.$router.push("login")}}}),aa=sa,ia=Object(x["a"])(aa,ta,ea,!1,null,null,null),na=ia.exports,oa=function(){var t=this,e=t._self._c;return e("div",{staticClass:"auth-layout"},[e("div",{staticClass:"auth-card"},[e("header",{staticClass:"auth-title"},[t._v("Connexion")]),e("div",{staticClass:"auth-content"},[e("div",{staticClass:"w-full"},[e("label",{attrs:{for:""}},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"auth-input",attrs:{type:"text"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),e("div",{staticClass:"w-full"},[e("label",{attrs:{for:""}},[t._v("Mot de passe")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"auth-input",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("button",{staticClass:"forget-password"},[t._v("Mot de passe oublié")])]),e("div",{staticClass:"auth-actions"},[e("button",{staticClass:"register-button",on:{click:t.goToRegister}},[t._v("S'enregistrer")]),e("button",{staticClass:"login-button",on:{click:t.login}},[t._v("Se connecter")])])])])},ra=[],la={data(){return{pseudo:void 0,email:void 0,password:void 0}},methods:{login:async function(){if(void 0==this.password&&void 0==this.email)return alert("Les champs sont requis !");const t=await je.login({email:this.email,password:this.password});if(!t)return console.log("ERROR: Une erreur est survenue lors de la connexion");this.$store.commit("setUser",t.user),this.$store.commit("setToken",t.token),this.$router.push("profile")},goToRegister:function(){this.$router.push("register")}}},ca=la,ua=Object(x["a"])(ca,oa,ra,!1,null,null,null),da=ua.exports;a["default"].use(p["a"]);const pa=new p["a"]({mode:"history",routes:[{path:"/",name:"home",component:xe},{path:"/login",name:"login",component:da},{path:"/register",name:"register",component:na},{path:"/profile",name:"profile",component:Ks},{path:"/studio",name:"studio",component:Zs}]});var ha=pa,ma=s("7496"),fa=s("f6c4"),ga=function(){var t=this,e=t._self._c;return e(ma["a"],{class:t.appClass,staticStyle:{"overflow-x":"auto"}},["session"!=t.$route.name?e("div",[e("Appbar")],1):t._e(),e(ma["a"],[t._l(this.$store.state.alerts,(function(t){return e("div",{key:t.id,staticStyle:{position:"absolute",top:"80px",right:"10px","z-index":"99"}},[e("Alert",{attrs:{alert:t}})],1)})),e(fa["a"],{class:t.$store.state.main_theme},[e("div",{attrs:{id:"app-content"}},[e("router-view")],1)])],2)],1)},va=[],ya=s("40dc"),ka=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(ya["a"],{attrs:{app:"",color:"#282828",dark:""}},[e("div",{staticClass:"d-flex justify-center align-center",staticStyle:{width:"100vw"},attrs:{id:"navbar"}},[e("div",{staticClass:"navbar-side-left"},[t.$store.state.user&&"profile"!=t.$route.name?e("a",{staticClass:"navlink",attrs:{href:"/profile"}},[t._v("Profile")]):e("a",{staticClass:"navlink",attrs:{href:"/"}},[t._v("Discover")])]),e("h1",{attrs:{id:"soundrecord-title"},on:{click:t.onClickLogo}},[t._v(" Sound"),e("span",{staticStyle:{color:"#EE1B1B"}},[t._v("Record")])]),e("div",{staticClass:"navbar-side-right"},[null==t.$store.state.user||"null"==t.$store.state.user?e("button",{on:{click:t.login}},[t._v(" Login ")]):e("button",{on:{click:t.logout}},[t._v(" Logout ")])])])])},Ca=[],Pa=(s("8b82"),{methods:{onClickLogo:function(){this.$router.push("/")},login:function(){this.$router.push("/login")},logout:function(){this.$store.commit("setToken",""),this.$store.commit("setUser",null),this.$router.push("/")}}}),_a=Pa,ba=Object(x["a"])(_a,ka,Ca,!1,null,null,null),wa=ba.exports;const Ia=window.localStorage.getItem("vuex")?JSON.parse(window.localStorage.getItem("vuex")).token:null,xa={baseURL:"http://localhost:3000",headers:{Authorization:"Bearer "+Ia}};var Ta=g.a.create(xa),Sa=s("0798"),$a=s("8336"),La=function(){var t=this,e=t._self._c;return e("div",[e(Sa["a"],{staticClass:"mx-auto -10 d-flex align-center",staticStyle:{width:"fit-content"},attrs:{elevation:"15",type:t.alert.type,transition:"scale-transition"},model:{value:t.alert.open,callback:function(e){t.$set(t.alert,"open",e)},expression:"alert.open"}},[e("div",{staticClass:"alert-content mr-10"},[Array.isArray(t.alert.message)?e("div",t._l(t.alert.message,(function(s){return e("div",{key:s},[t._v(" "+t._s(s)+" ")])})),0):e("div",[t._v(" "+t._s(t.alert.message)+" ")])]),e($a["a"],{staticClass:"ma-0 pa-0",staticStyle:{right:"5px",position:"absolute",top:"10px"},attrs:{color:"red",icon:""},on:{click:function(e){return t.removeAlert(t.alert)}}},[e(D["a"],[t._v("mdi-close")])],1)],1)],1)},Oa=[],Ea={name:"alert_service",props:{alert:{required:!0}},mounted(){setTimeout(()=>{this.$store.commit("remove_alert",this.alert.id)},1e4)},methods:{removeAlert:function(t){t.open=!1,this.$store.commit("remove_alert",t.id)}}},Aa=Ea,Ra=Object(x["a"])(Aa,La,Oa,!1,null,null,null),Na=Ra.exports,ja=(s("dea3"),{components:{Appbar:wa,Alert:Na},data(){return{appClass:""}},mounted(){this.is_loggedIn()},methods:{is_loggedIn:function(){Ta.get("/api/auth/").catch(()=>{this.$store.commit("setUser",void 0),"login"!==this.$route.name|"register"&&"home"!==this.$route.name&&"profile"!==this.$route.name&&this.$router.push("login")})}}}),qa=ja,Ua=Object(x["a"])(qa,ga,va,!1,null,null,null),Da=Ua.exports;s("7d05"),s("c987");window.localStorage.getItem("vuex")||window.localStorage.setItem("vuex","{}"),a["default"].use(o["a"]),a["default"].config.productionTip=!0,window.addEventListener("resize",()=>{d.commit("setWidth",window.innerwidth)});const za=new a["default"]({vuetify:n,store:d,router:ha,render:t=>t(Da)}).$mount("#app");window.App=za},"59a2":function(t,e,s){},"772f":function(t,e,s){},"7d05":function(t,e,s){},"7f51":function(t,e,s){},8988:function(t,e,s){},"8b82":function(t,e,s){},"8c5b":function(t,e,s){},acf2:function(t,e,s){},b282:function(t,e,s){},b93d:function(t,e,s){},ba9b:function(t,e,s){},be3f:function(t,e,s){},c044:function(t,e,s){},c054:function(t,e,s){},c608:function(t,e,s){},c922:function(t,e,s){},c987:function(t,e,s){},cc38:function(t,e,s){},d818:function(t,e,s){},dea3:function(t,e,s){},e991:function(t,e,s){},ea26:function(t,e,s){},f702:function(t,e,s){},f797:function(t,e,s){},fb3a:function(t,e,s){},fd3a:function(t,e,s){}});
//# sourceMappingURL=app.79014625.js.map